<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>uextract ‚Äì UE Audio Extractor</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet"></noscript>
  <style>
    :root {
      --bg-deep: #1a1625;
      --bg-panel: #201c2a;
      --bg-card: #282336;
      --bg-hover: #322c42;
      --border: #3a3450;
      --text: #f0ecf8;
      --text-muted: #a898c0;
      --text-dim: #786890;
      --accent: #ff7eb3;
      --accent-dim: rgba(255, 126, 179, 0.15);
      --accent-secondary: #7c5cff;
      --ue-blue: #00d4ff;
      --ue-dim: rgba(0, 212, 255, 0.12);
      --warning: #ffcc70;
      --error: #ff7b7b;
      --success: #7dffb3;
      --font-mono: 'JetBrains Mono', ui-monospace, 'Cascadia Code', monospace;
      --font-sans: 'Nunito', system-ui, -apple-system, sans-serif;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; overflow: hidden; }
    body { font-family: var(--font-sans); background: var(--bg-deep); color: var(--text); display: flex; flex-direction: column; }

    /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
    .header {
      background: var(--bg-panel);
      border-bottom: 1px solid var(--border);
      padding: 8px 12px;
      display: flex; align-items: center; gap: 12px;
      flex-shrink: 0;
    }
    .logo { display: flex; align-items: center; gap: 10px; }
    .logo-icon {
      width: 32px; height: 32px;
      background: var(--ue-blue); border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
      font-size: 16px; color: var(--bg-deep);
    }
    .logo h1 { font-size: 18px; font-weight: 700; letter-spacing: -0.3px; }
    .logo h1 .ue { color: var(--ue-blue); }
    .logo .subtitle {
      color: var(--text-dim); font-size: 11px; font-weight: 600;
      margin-left: 6px; background: var(--bg-card); padding: 2px 8px;
      border-radius: 10px; border: 1px solid var(--border);
    }
    .header-actions { margin-left: auto; display: flex; gap: 6px; }

    /* ‚îÄ‚îÄ Main layout ‚îÄ‚îÄ */
    .main { flex: 1; display: flex; overflow: hidden; }

    /* ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ */
    .sidebar {
      width: 380px; min-width: 260px; background: var(--bg-panel);
      border-right: 1px solid var(--border);
      display: flex; flex-direction: column; flex-shrink: 0;
    }
    .sidebar-toolbar {
      padding: 6px; border-bottom: 1px solid var(--border);
      display: flex; flex-direction: column; gap: 4px;
    }
    .sidebar-toolbar-row {
      display: flex; align-items: center; gap: 6px;
    }
    .file-count {
      margin-left: auto; font-family: var(--font-mono); font-size: 11px;
      color: var(--ue-blue); padding: 2px 8px; border-radius: 10px;
      background: var(--ue-dim); font-weight: 600;
    }
    .filter-pills { display: flex; gap: 2px; flex-wrap: wrap; }
    .filter-pill {
      font-family: var(--font-sans); font-size: 12px; font-weight: 600;
      padding: 6px 12px; border-radius: 8px; cursor: pointer;
      background: transparent; color: var(--text-dim);
      border: 1px solid transparent; transition: background 0.1s, color 0.1s;
    }
    .filter-pill:hover { background: var(--bg-hover); color: var(--text-muted); }
    .filter-pill.active { background: var(--accent-dim); color: var(--accent); border-color: var(--accent); }
    .filter-pill .pill-count {
      font-family: var(--font-mono); font-size: 10px;
      color: var(--text-dim); margin-left: 2px;
    }
    .filter-pill.active .pill-count { color: var(--accent); }

    /* ‚îÄ‚îÄ Search ‚îÄ‚îÄ */
    .search-input {
      flex: 1; min-width: 0;
      background: var(--bg-card); border: 1px solid var(--border);
      border-radius: 8px; padding: 8px 12px;
      font-family: var(--font-sans); font-size: 13px;
      color: var(--text); outline: none;
      transition: border-color 0.15s;
    }
    .search-input::placeholder { color: var(--text-dim); }
    .search-input:focus { border-color: var(--ue-blue); }
    .search-clear {
      background: none; border: none; color: var(--text-dim);
      cursor: pointer; font-size: 18px; padding: 6px 8px;
      line-height: 1; border-radius: 6px;
      transition: color 0.1s, background 0.1s;
    }
    .search-clear:hover { color: var(--text); background: var(--bg-hover); }

    /* ‚îÄ‚îÄ Tree ‚îÄ‚îÄ */
    .tree-container { flex: 1; overflow-y: auto; overflow-x: hidden; padding: 2px 0; scrollbar-width: auto; scrollbar-color: var(--border) transparent; }
    .tree-container::-webkit-scrollbar { width: 14px; }
    .tree-container::-webkit-scrollbar-track { background: transparent; }
    .tree-container::-webkit-scrollbar-thumb { background: var(--border); border-radius: 7px; min-height: 40px; }
    .tree-container::-webkit-scrollbar-thumb:hover { background: var(--text-dim); }

    .tree-item {
      display: flex; align-items: center;
      padding: 3px 4px; cursor: pointer;
      gap: 4px; font-size: 12px;
      border-radius: 3px; margin: 0 2px;
      transition: background 0.1s;
    }
    .tree-item:hover { background: var(--bg-hover); }
    .tree-item.active { background: var(--accent-dim); color: var(--accent); }
    .tree-item.filtered-out { display: none; }
    .tree-item .icon { width: 14px; font-size: 11px; flex-shrink: 0; text-align: center; }
    .tree-item .name {
      flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .tree-item .type-badge {
      font-family: var(--font-mono); font-size: 8px; font-weight: 600;
      padding: 1px 4px; border-radius: 3px; flex-shrink: 0;
      color: var(--text-dim); background: var(--bg-card);
    }
    .tree-item .type-badge.tb-audio { color: var(--ue-blue); background: var(--ue-dim); }
    .tree-item .type-badge.tb-dlg { color: var(--success); background: rgba(125,255,179,0.1); }
    .tree-item .type-badge.tb-wem { color: var(--warning); background: rgba(255,204,112,0.1); }

    .tree-folder { margin: 0; }
    .tree-folder-header {
      display: flex; align-items: center;
      padding: 3px 4px; cursor: pointer;
      gap: 3px; font-size: 12px; font-weight: 600;
      margin: 0 2px; border-radius: 3px;
      color: var(--text-muted);
      transition: background 0.1s;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .tree-folder-header:hover { background: var(--bg-hover); }
    .tree-folder-header .chevron {
      width: 12px; font-size: 8px; color: var(--text-dim);
      transition: transform 0.15s;
    }
    .tree-folder-header.collapsed .chevron { transform: rotate(-90deg); }
    .tree-folder-children { padding-left: 8px; }
    .tree-folder-children.hidden { display: none; }
    .tree-folder.filtered-out { display: none; }

    /* ‚îÄ‚îÄ Content area ‚îÄ‚îÄ */
    .content { flex: 1; display: flex; flex-direction: column; overflow: hidden; }

    /* ‚îÄ‚îÄ Dropzone ‚îÄ‚îÄ */
    .dropzone-wrapper { padding: 12px; flex-shrink: 0; }
    .dropzone-wrapper.collapsed { padding: 6px 12px; }
    .dropzone {
      border: 2px dashed var(--border); border-radius: 12px;
      padding: 40px 24px; text-align: center; cursor: pointer;
      transition: border-color 0.2s, background 0.2s;
      background: var(--bg-card);
    }
    .dropzone:hover { border-color: var(--accent); }
    .dropzone.dragover { border-color: var(--ue-blue); background: var(--ue-dim); }
    .dropzone h3 { font-size: 17px; font-weight: 700; margin-bottom: 6px; }
    .dropzone-icon { font-size: 36px; margin-bottom: 10px; display: block; }
    .dropzone p { color: var(--text-muted); font-size: 13px; }
    .dropzone .hint {
      margin-top: 12px; font-family: var(--font-mono); font-size: 11px;
      color: var(--text-dim); background: var(--bg-panel); padding: 6px 12px;
      border-radius: 6px; display: inline-block; border: 1px solid var(--border);
    }
    .dropzone-mini {
      display: flex; align-items: center; gap: 8px;
      padding: 6px 12px; border-radius: 8px;
      border: 1px dashed var(--border); cursor: pointer;
      font-size: 12px; color: var(--text-dim);
      transition: border-color 0.15s;
    }
    .dropzone-mini:hover { border-color: var(--accent); color: var(--text-muted); }

    .progress-bar {
      height: 4px; background: var(--bg-card); border-radius: 4px;
      overflow: hidden; margin: 8px 0;
    }
    .progress-bar .fill {
      height: 100%; width: 0%;
      background: linear-gradient(90deg, var(--ue-blue), var(--accent));
      transition: width 0.15s;
    }
    .loading {
      display: flex; align-items: center; gap: 10px;
      padding: 8px 0; color: var(--text-muted); font-size: 13px; font-weight: 600;
    }
    .spinner {
      width: 16px; height: 16px;
      border: 2px solid var(--border); border-top-color: var(--ue-blue);
      border-radius: 50%; animation: spin 0.6s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* ‚îÄ‚îÄ Detail panel ‚îÄ‚îÄ */
    .detail-panel {
      flex: 1; overflow-y: auto; padding: 12px;
      scrollbar-width: auto; scrollbar-color: var(--border) transparent;
    }
    .detail-panel::-webkit-scrollbar { width: 14px; }
    .detail-panel::-webkit-scrollbar-track { background: transparent; }
    .detail-panel::-webkit-scrollbar-thumb { background: var(--border); border-radius: 7px; min-height: 40px; }
    .detail-panel::-webkit-scrollbar-thumb:hover { background: var(--text-dim); }

    .detail-empty {
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      height: 100%; text-align: center; color: var(--text-dim);
    }
    .detail-empty .de-icon { font-size: 40px; margin-bottom: 12px; opacity: 0.5; }
    .detail-empty p { font-size: 14px; }

    .detail-header { margin-bottom: 12px; }
    .detail-name { font-size: 16px; font-weight: 700; margin-bottom: 2px; }
    .detail-path { font-family: var(--font-mono); font-size: 11px; color: var(--text-dim); margin-bottom: 8px; word-break: break-all; }
    .detail-tags { display: flex; gap: 6px; flex-wrap: wrap; }

    .detail-section {
      background: var(--bg-card); border: 1px solid var(--border);
      border-radius: 8px; padding: 10px; margin-bottom: 8px;
    }
    .detail-section-title {
      font-size: 11px; font-weight: 700; text-transform: uppercase;
      letter-spacing: 0.5px; color: var(--text-dim); margin-bottom: 8px;
    }

    .track-row {
      display: flex; flex-direction: column; gap: 8px;
      padding: 8px 0;
      border-bottom: 1px solid var(--border);
    }
    .track-row:last-child { border-bottom: none; padding-bottom: 0; }
    .track-row:first-child { padding-top: 0; }
    .track-meta { display: flex; gap: 6px; flex-wrap: wrap; align-items: center; }
    .track-player { width: 100%; }
    .track-player audio { width: 100%; height: 32px; border-radius: 6px; outline: none; }
    .track-player audio::-webkit-media-controls-panel { background: var(--bg-hover); }
    .track-actions { display: flex; gap: 6px; }
    .wwise-notice {
      display: flex; align-items: center; gap: 8px;
      padding: 8px 10px; background: rgba(255,204,112,0.06);
      border: 1px solid rgba(255,204,112,0.2); border-radius: 6px;
      color: var(--warning); font-size: 12px;
    }

    .dialogue-lines {
      max-height: 240px; overflow-y: auto;
      background: var(--bg-hover); border-radius: 6px;
      padding: 8px 10px; border: 1px solid var(--border);
      scrollbar-width: auto; scrollbar-color: var(--border) transparent;
    }
    .dialogue-lines::-webkit-scrollbar { width: 14px; }
    .dialogue-lines::-webkit-scrollbar-thumb { background: var(--border); border-radius: 7px; }
    .dialogue-lines::-webkit-scrollbar-thumb:hover { background: var(--text-dim); }
    .dialogue-line {
      padding: 4px 0; font-size: 13px; line-height: 1.5;
      color: var(--text-muted); border-bottom: 1px solid rgba(58,52,80,0.5);
    }
    .dialogue-line:last-child { border-bottom: none; }

    /* ‚îÄ‚îÄ Dialogue Browser ‚îÄ‚îÄ */
    .dlg-resolved {
      display: block; font-family: var(--font-mono); font-size: 9px;
      color: var(--ue-blue); opacity: 0.7; white-space: nowrap;
      overflow: hidden; text-overflow: ellipsis; margin-top: 1px;
    }

    .meta-tag {
      font-family: var(--font-mono); font-size: 10px; font-weight: 600;
      padding: 2px 6px; border-radius: 4px;
      color: var(--text-dim); background: var(--bg-hover); border: 1px solid var(--border);
    }
    .meta-tag.type-ogg { color: var(--ue-blue); background: var(--ue-dim); border-color: rgba(0,212,255,0.2); }
    .meta-tag.type-wav { color: var(--warning); background: rgba(255,204,112,0.1); border-color: rgba(255,204,112,0.2); }
    .meta-tag.type-wem { color: var(--error); background: rgba(255,123,123,0.08); border-color: rgba(255,123,123,0.2); }
    .meta-tag.type-dlg { color: var(--success); background: rgba(125,255,179,0.08); border-color: rgba(125,255,179,0.2); }

    /* ‚îÄ‚îÄ Buttons ‚îÄ‚îÄ */
    .btn {
      display: inline-flex; align-items: center; gap: 6px;
      padding: 8px 14px; border-radius: 8px;
      font-family: var(--font-sans); font-size: 13px; font-weight: 600;
      cursor: pointer; border: 1px solid transparent;
      transition: background 0.1s, border-color 0.1s;
      min-height: 36px;
    }
    .btn-primary { background: var(--accent); color: var(--bg-deep); }
    .btn-primary:hover { background: #ff5c9a; }
    .btn-secondary { background: var(--bg-hover); color: var(--text); border-color: var(--border); }
    .btn-secondary:hover { background: var(--bg-card); border-color: var(--text-dim); }
    .btn-ghost { background: transparent; color: var(--text-muted); }
    .btn-ghost:hover { background: var(--bg-hover); color: var(--text); }
    .btn:disabled { opacity: 0.35; cursor: not-allowed; }

    /* ‚îÄ‚îÄ Stats bar ‚îÄ‚îÄ */
    .stats-bar {
      display: flex; gap: 16px; padding: 8px 12px;
      background: var(--bg-card); border-radius: 8px;
      margin-bottom: 8px; border: 1px solid var(--border); flex-wrap: wrap;
    }
    .stat { display: flex; align-items: center; gap: 6px; }
    .stat-value { font-family: var(--font-mono); font-weight: 700; color: var(--ue-blue); font-size: 14px; }
    .stat-label { color: var(--text-dim); font-size: 12px; }

    /* ‚îÄ‚îÄ Responsive ‚îÄ‚îÄ */
    @media (max-width: 900px) { .sidebar { width: 300px; } }
    @media (max-width: 600px) {
      .main { flex-direction: column; }
      .sidebar { width: 100%; max-height: 40vh; border-right: none; border-bottom: 1px solid var(--border); }
    }
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
    }
    .hidden-input { display: none; }

    /* ‚îÄ‚îÄ Staging UI ‚îÄ‚îÄ */
    .staged-list {
      text-align: left; max-height: 140px; overflow-y: auto;
      margin: 8px auto; max-width: 340px;
      scrollbar-width: auto; scrollbar-color: var(--border) transparent;
    }
    .staged-list::-webkit-scrollbar { width: 14px; }
    .staged-list::-webkit-scrollbar-thumb { background: var(--border); border-radius: 7px; }
    .staged-list::-webkit-scrollbar-thumb:hover { background: var(--text-dim); }
    .staged-folder {
      display: flex; align-items: center; gap: 6px;
      padding: 5px 8px; font-size: 12px; color: var(--text-muted);
      background: var(--bg-hover); border-radius: 6px; margin-bottom: 3px;
    }
    .staged-folder .folder-name {
      flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
    }
    .staged-folder .remove-staged {
      background: none; border: none; color: var(--text-dim);
      cursor: pointer; font-size: 14px; padding: 0 2px; line-height: 1;
    }
    .staged-folder .remove-staged:hover { color: var(--error); }
    .staged-actions {
      display: flex; gap: 8px; justify-content: center; margin-top: 10px;
    }
  </style>
</head>
<body>

<header class="header">
  <div class="logo">
    <div class="logo-icon">üéµ</div>
    <h1><span class="ue">ue</span><span class="xtract">xtract</span></h1>
    <span class="subtitle">browser-only</span>
  </div>
  <div class="header-actions">
    <button id="downloadAllOggBtn" class="btn btn-secondary" disabled><span>üì•</span> All OGG</button>
    <button id="downloadAllWavBtn" class="btn btn-secondary" disabled><span>üì•</span> All WAV</button>
    <button id="resetBtn" class="btn btn-ghost" disabled><span>üîÑ</span> Reset</button>
  </div>
</header>

<main class="main">
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-toolbar" id="sidebarToolbar">
      <div class="sidebar-toolbar-row">
        <span style="font-size:13px;font-weight:700;color:var(--text-muted)">Files</span>
        <span class="file-count" id="fileCount">0</span>
      </div>
      <div class="sidebar-toolbar-row" id="searchRow" style="display:none">
        <input type="text" class="search-input" id="searchInput" placeholder="Search files..." />
        <button class="search-clear" id="searchClear" title="Clear search" style="display:none">‚úï</button>
      </div>
      <div class="filter-pills" id="filterPills" style="display:none">
        <button class="filter-pill active" data-filter="all">All</button>
        <button class="filter-pill" data-filter="audio">Audio <span class="pill-count" id="cntAudio">0</span></button>
        <button class="filter-pill" data-filter="dialogue">Dialogue <span class="pill-count" id="cntDlg">0</span></button>
        <button class="filter-pill" data-filter="wwise">Wwise <span class="pill-count" id="cntWwise">0</span></button>
        <button class="filter-pill" data-filter="data">Other <span class="pill-count" id="cntData">0</span></button>
      </div>
    </div>
    <div class="tree-container" id="treeContainer">
      <div class="detail-empty" style="padding:30px 16px">
        <div class="de-icon">üéÆ</div><p>Drop files to browse</p>
      </div>
    </div>
  </aside>

  <section class="content" id="contentArea">
    <div class="dropzone-wrapper" id="dropzoneWrapper">
      <div id="dropzone" class="dropzone">
        <span class="dropzone-icon">üì¶</span>
        <h3>Drop your Unreal assets here</h3>
        <p>Drag folders or .uasset / .uexp / .ubulk files</p>
        <div class="hint">OGG/WAV ¬∑ Wwise WEM ¬∑ DlgSystem dialogue ¬∑ .ubulk</div>
        <input id="fileInput" type="file" class="hidden-input" webkitdirectory multiple />
      </div>
      <div class="progress-bar" id="progressBar" style="display:none"><div class="fill" id="progressFill"></div></div>
      <div id="statusText" class="loading" style="display:none"><div class="spinner"></div><span>Processing...</span></div>
    </div>
    <div class="detail-panel" id="detailPanel" style="display:none"></div>
  </section>
</main>

<script>
// ============================================================
// uextract ‚Äì Lazy UE Audio Extractor
// ============================================================

const $ = id => document.getElementById(id);
const dropzone = $('dropzone');
const fileInput = $('fileInput');
const treeContainer = $('treeContainer');
const fileCountEl = $('fileCount');
// progressBar, progressFill, statusText are looked up live (they get recreated by resetUI / processFiles)
const dropzoneWrapper = $('dropzoneWrapper');
const detailPanel = $('detailPanel');
const filterPills = $('filterPills');
const downloadAllOggBtn = $('downloadAllOggBtn');
const downloadAllWavBtn = $('downloadAllWavBtn');
const resetBtn = $('resetBtn');

// Signatures
const SIG_OGG  = [0x4F,0x67,0x67,0x53];
const SIG_RIFF = [0x52,0x49,0x46,0x46];
const SIG_FMT  = [0x66,0x6D,0x74,0x20];
const SIG_DATA = [0x64,0x61,0x74,0x61];

const FMT_PCM = 0x0001, FMT_ADPCM = 0x0002, FMT_EXT = 0xFFFE, FMT_VORBIS = 0xFFFF;
const FMT_LABEL = { [FMT_PCM]:'PCM', [FMT_ADPCM]:'ADPCM', [FMT_EXT]:'Wwise PCM', [FMT_VORBIS]:'Wwise Vorbis' };
const SIG_VORB = [0x76,0x6F,0x72,0x62];

// State
let allAssets = [];
let fileTree = {};
let selectedAsset = null;
let currentFilter = 'all';
let activeBlobUrl = null;   // only one at a time (lazy)
let treeItemEls = [];       // for filtering
let crossRef = { eventToMedia: {}, mediaToEvent: {}, dialogueData: {}, mediaToDialogue: {}, assetByName: {} };
let fileTreeFrag = null;    // cached file-tree DOM when switching to dialogue view
let stagedEntries = [];     // { name, files: File[]|null } per queued folder
let isStaging = false;
let stagingBusy = 0;        // folders still loading file lists

// Perf
let lastPT = 0;
function yieldToMain() { return new Promise(r => setTimeout(r, 0)); }
function throttleProg(p) {
  const n = performance.now();
  if (n - lastPT > 40 || p >= 99.9) { const el = $('progressFill'); if (el) el.style.width = p + '%'; lastPT = n; }
}

// ============================================================
// Events
// ============================================================
dropzone.addEventListener('click', onDropzoneClick);
dropzone.addEventListener('dragover', e => { e.preventDefault(); dropzone.classList.add('dragover'); });
dropzone.addEventListener('dragleave', () => dropzone.classList.remove('dragover'));
dropzone.addEventListener('drop', handleDrop);
fileInput.addEventListener('change', e => stageFolder(e.target.files));
resetBtn.addEventListener('click', resetUI);
downloadAllOggBtn.addEventListener('click', () => downloadAllAudio('ogg'));
downloadAllWavBtn.addEventListener('click', () => downloadAllAudio('wav'));

filterPills.addEventListener('click', e => {
  const pill = e.target.closest('.filter-pill');
  if (!pill) return;
  filterPills.querySelector('.active')?.classList.remove('active');
  pill.classList.add('active');
  currentFilter = pill.dataset.filter;
  applyFilter();
});

$('searchInput').addEventListener('input', e => {
  const clear = $('searchClear');
  if (clear) clear.style.display = e.target.value ? '' : 'none';
  applyFilter();
});
$('searchClear').addEventListener('click', () => {
  const si = $('searchInput');
  if (si) { si.value = ''; si.focus(); }
  const clear = $('searchClear');
  if (clear) clear.style.display = 'none';
  applyFilter();
});

async function handleDrop(e) {
  e.preventDefault();
  const dz = $('dropzone');
  if (dz) dz.classList.remove('dragover');
  const items = e.dataTransfer.items; const files = [];
  if (items) {
    const entries = [];
    for (const it of items) { const en = it.webkitGetAsEntry?.(); if (en) entries.push(en); }
    if (entries.length) {
      // Show immediate feedback on the dropzone itself
      if (dz) { dz.innerHTML = '<div class="spinner"></div><h3>Scanning folder\u2026</h3><p>0 files found</p>'; }
      showStatus('Scanning\u2026');
      await yieldToMain();                       // let the browser paint before heavy I/O
      for (const en of entries) await walkTree(en, files);
      if (dz) { const p = dz.querySelector('p'); if (p) p.textContent = files.length.toLocaleString() + ' files found'; }
      showStatus('Scanned ' + files.length.toLocaleString() + ' files \u2013 loading\u2026');
      await yieldToMain();
    }
  }
  if (files.length > 0) await processFiles(files);
  else if (e.dataTransfer.files.length > 0) await processFiles(e.dataTransfer.files);
}

async function walkTree(entry, files, path = '') {
  if (entry.isFile) {
    const f = await new Promise(r => entry.file(r));
    f.relativePath = path + f.name; files.push(f);
    // Yield every 200 files so the browser can repaint the counter
    if (files.length % 200 === 0) {
      const cnt = files.length.toLocaleString();
      showStatus('Scanning\u2026 ' + cnt + ' files found');
      const dz = $('dropzone'); if (dz) { const p = dz.querySelector('p'); if (p) p.textContent = cnt + ' files found'; }
      await yieldToMain();
    }
  } else if (entry.isDirectory) {
    const reader = entry.createReader();
    const all = await new Promise(res => {
      const a = []; const read = () => reader.readEntries(b => { if (!b.length) res(a); else { a.push(...b); read(); } }); read();
    });
    for (const c of all) await walkTree(c, files, path + entry.name + '/');
  }
}

// ============================================================
// Multi-folder staging (file picker only allows 1 folder at a time)
// ============================================================
function onDropzoneClick(e) {
  const btn = e.target.closest('button');
  if (btn) {
    if (btn.id === 'addMoreBtn') { const fi = $('fileInput'); if (fi) fi.click(); }
    else if (btn.id === 'importAllBtn') importStaged();
    else if (btn.classList.contains('remove-staged')) removeStaged(+btn.dataset.idx);
    return;
  }
  if (!isStaging) { const fi = $('fileInput'); if (fi) fi.click(); }
}

function stageFolder(fileList) {
  if (!fileList || !fileList.length) return;
  const firstPath = fileList[0].webkitRelativePath || fileList[0].relativePath || fileList[0].name;
  const folderName = firstPath.split('/')[0] || 'Selected files';
  const entry = { name: folderName, files: null };
  stagedEntries.push(entry);
  isStaging = true;
  stagingBusy++;
  renderStagingUI();
  // Capture files asynchronously so the folder appears in the list instantly
  const fl = fileList;
  setTimeout(() => {
    entry.files = Array.from(fl);
    stagingBusy--;
    updateImportBtn();
  }, 0);
}

function renderStagingUI() {
  const dz = $('dropzone');
  if (!dz) return;
  let html = '<span class="dropzone-icon">üì¶</span>' +
    '<h3>' + stagedEntries.length + ' folder' + (stagedEntries.length !== 1 ? 's' : '') + ' selected</h3>' +
    '<div class="staged-list">';
  for (let i = 0; i < stagedEntries.length; i++) {
    html += '<div class="staged-folder">' +
      '<span>üìÅ</span><span class="folder-name">' + esc(stagedEntries[i].name) + '</span>' +
      '<button class="remove-staged" data-idx="' + i + '" title="Remove">‚úï</button></div>';
  }
  html += '</div>' +
    '<div class="staged-actions">' +
      '<button class="btn btn-secondary" id="addMoreBtn">üìÅ Add Folder</button>' +
      '<button class="btn btn-primary" id="importAllBtn" disabled>' +
        '<span class="spinner" style="width:12px;height:12px;border-width:2px;vertical-align:middle"></span> Preparing\u2026' +
      '</button>' +
    '</div>' +
    '<input id="fileInput" type="file" class="hidden-input" webkitdirectory multiple />';
  dz.innerHTML = html;
  $('fileInput').addEventListener('change', e => stageFolder(e.target.files));
  if (stagingBusy === 0) updateImportBtn();
}

function updateImportBtn() {
  const btn = $('importAllBtn');
  if (!btn) return;
  if (stagingBusy > 0) {
    btn.disabled = true;
    btn.innerHTML = '<span class="spinner" style="width:12px;height:12px;border-width:2px;vertical-align:middle"></span> Preparing\u2026';
  } else {
    const total = stagedEntries.reduce((s, e) => s + (e.files ? e.files.length : 0), 0);
    btn.disabled = false;
    btn.textContent = '\uD83D\uDCE5 Import ' + total.toLocaleString() + ' Files';
  }
}

function removeStaged(idx) {
  if (idx < 0 || idx >= stagedEntries.length) return;
  stagedEntries.splice(idx, 1);
  if (stagedEntries.length === 0) clearStaged();
  else renderStagingUI();
}

function clearStaged() {
  stagedEntries = []; isStaging = false; stagingBusy = 0;
  const dz = $('dropzone');
  if (dz) {
    dz.innerHTML = '<span class="dropzone-icon">üì¶</span>' +
      '<h3>Drop your Unreal assets here</h3>' +
      '<p>Drag folders or .uasset / .uexp / .ubulk files</p>' +
      '<div class="hint">OGG/WAV ¬∑ Wwise WEM ¬∑ DlgSystem dialogue ¬∑ .ubulk</div>' +
      '<input id="fileInput" type="file" class="hidden-input" webkitdirectory multiple />';
    $('fileInput').addEventListener('change', e => stageFolder(e.target.files));
  }
}

async function importStaged() {
  if (stagingBusy > 0) return;
  const files = [];
  for (const entry of stagedEntries) { if (entry.files) files.push(...entry.files); }
  stagedEntries = []; isStaging = false; stagingBusy = 0;
  if (files.length) await processFiles(files);
}

// ============================================================
// Processing (lightweight ‚Äì no Blob creation)
// ============================================================
async function processFiles(fileList) {
  if (!fileList || !fileList.length) return;
  resetUI(); showProgress(0); showStatus('Reading files...');

  const files = Array.from(fileList);
  const assets = files.filter(f => { const n = f.name.toLowerCase(); return n.endsWith('.uasset') || n.endsWith('.uexp') || n.endsWith('.ubulk'); });
  if (!assets.length) { showStatus('No .uasset / .uexp / .ubulk files found'); setTimeout(hideStatus, 2000); hideProgress(); return; }

  showStatus('Reading ' + assets.length.toLocaleString() + ' asset files\u2026');
  fileCountEl.textContent = assets.length;
  resetBtn.disabled = false;

  // Read in parallel batches
  const B = 40, fileData = [];
  for (let i = 0; i < assets.length; i += B) {
    const sl = assets.slice(i, i + B);
    const res = await Promise.all(sl.map(async f => ({ file: f, buffer: await f.arrayBuffer(), path: f.relativePath || f.webkitRelativePath || f.name })));
    fileData.push(...res);
    throttleProg((i + sl.length) / assets.length * 40);
    if (i + B < assets.length) await yieldToMain();
  }

  showStatus('Grouping...');
  const packages = groupPackages(fileData);
  await yieldToMain();

  // Lightweight scan (metadata + audio descriptors, NO Blobs)
  showStatus('Scanning...');
  allAssets = [];
  const pkgs = Object.values(packages);
  for (let i = 0; i < pkgs.length; i += B) {
    const sl = pkgs.slice(i, i + B);
    for (const pkg of sl) { const r = scanPackage(pkg); if (r) allAssets.push(r); }
    throttleProg(40 + Math.min(i + B, pkgs.length) / pkgs.length * 60);
    if (i + B < pkgs.length) await yieldToMain();
  }

  hideProgress(); hideStatus();

  // Build cross-reference index (event‚Üímedia, dialogue‚Üíevents)
  showStatus('Building cross-references\u2026');
  await yieldToMain();
  buildCrossRef();
  hideStatus();

  // Collapse dropzone, show tree
  dropzoneWrapper.classList.add('collapsed');
  dropzoneWrapper.innerHTML =
    '<div class="dropzone-mini" id="dropzoneMini">üì¶ Drop more files or click to add' +
    '<input id="fileInput2" type="file" class="hidden-input" webkitdirectory multiple /></div>' +
    '<div class="progress-bar" id="progressBar" style="display:none"><div class="fill" id="progressFill"></div></div>' +
    '<div id="statusText" class="loading" style="display:none"><div class="spinner"></div><span></span></div>';
  $('dropzoneMini').addEventListener('click', () => $('fileInput2').click());
  $('fileInput2').addEventListener('change', e => processFiles(e.target.files));

  // Update filter counts
  const counts = { audio: 0, dialogue: 0, wwise: 0, data: 0 };
  for (const a of allAssets) {
    const tags = assetTags(a);
    if (tags.has('audio')) counts.audio++;
    if (tags.has('dialogue')) counts.dialogue++;
    if (tags.has('wwise')) counts.wwise++;
    if (tags.has('data')) counts.data++;
  }
  // Use cross-ref dialogue count if higher (catches dialogues even with 0 extracted text lines)
  const dlgCount = Object.keys(crossRef.dialogueData).length;
  if (dlgCount > counts.dialogue) counts.dialogue = dlgCount;
  $('cntAudio').textContent = counts.audio;
  $('cntDlg').textContent = counts.dialogue;
  $('cntWwise').textContent = counts.wwise;
  $('cntData').textContent = counts.data;
  filterPills.style.display = '';
  $('searchRow').style.display = '';

  const hasPlayable = counts.audio > 0;
  downloadAllOggBtn.disabled = !hasPlayable;
  downloadAllWavBtn.disabled = !hasPlayable;

  // Build & render flat file tree
  buildFileTree(packages);
  renderFileTree();

  // Show detail-empty
  showDetailEmpty();
}

function groupPackages(data) {
  const pkgs = {};
  for (const { file, buffer, path } of data) {
    const m = file.name.match(/^(.+)\.(uasset|uexp|ubulk)$/i);
    if (!m) continue;
    const base = m[1], ext = m[2].toLowerCase(), dir = path.replace(/[^\/\\]*$/, ''), key = dir + base;
    if (!pkgs[key]) pkgs[key] = { name: base, path: dir, fullPath: key, files: {} };
    pkgs[key].files[ext] = { file, buffer };
  }
  return pkgs;
}

// ============================================================
// Lightweight scan ‚Äì only metadata + audio descriptors
// ============================================================
function scanPackage(pkg) {
  const { name, path, files, fullPath } = pkg;
  let meta = { type: 'Unknown', assetName: name, format: null };
  let isDlg = false;
  let refs = { events: [], media: [], character: null };
  if (files.uasset) {
    meta = parseUAssetMeta(files.uasset.buffer);
    meta.assetName = meta.assetName || name;
    isDlg = meta.type.startsWith('Dlg') || meta.type === 'DialogueWave';
    refs = extractAssetRefs(files.uasset.buffer);
  }
  const tracks = [];
  if (files.uexp)  scanAudio(new Uint8Array(files.uexp.buffer), tracks, 'uexp');
  if (files.ubulk) scanAudio(new Uint8Array(files.ubulk.buffer), tracks, 'ubulk');

  const dlgLines = (isDlg && files.uexp) ? extractDlgText(new Uint8Array(files.uexp.buffer)) : [];

  return { name, path, fullPath, meta, tracks, dlgLines, refs, _files: files };
}

function scanAudio(bytes, out, src) {
  // OGG
  const oo = findSig(bytes, SIG_OGG, 0);
  if (oo !== -1) {
    out.push({ type:'ogg', format:'OGG Vorbis', code:0, ch:null, sr:null, bps:0, playable:true, src, off:oo, end:bytes.length });
  }
  // RIFF
  let sf = 0;
  while (sf < bytes.length - 12) {
    const ro = findSig(bytes, SIG_RIFF, sf);
    if (ro === -1) break;
    if (bytes[ro+8]!==0x57||bytes[ro+9]!==0x41||bytes[ro+10]!==0x56||bytes[ro+11]!==0x45) { sf=ro+4; continue; }
    const rv = new DataView(bytes.buffer, bytes.byteOffset+ro);
    const rSz = rv.getUint32(4,true);
    const rEnd = Math.min(bytes.length, ro+rSz+8);
    const fmtO = findSig(bytes, SIG_FMT, ro+12);
    if (fmtO===-1||fmtO>=rEnd) { sf=ro+4; continue; }
    const fv = new DataView(bytes.buffer, bytes.byteOffset+fmtO);
    const af=fv.getUint16(8,true), ch=fv.getUint16(10,true), sr=fv.getUint32(12,true), bps=fv.getUint16(22,true);
    const label = FMT_LABEL[af]||('0x'+af.toString(16));
    const playable = af===FMT_PCM||af===FMT_EXT||af===FMT_VORBIS;
    const tp = af===FMT_ADPCM ? 'wem' : af===FMT_VORBIS ? 'ogg' : 'wav';
    out.push({ type:tp, format:label, code:af, ch, sr, bps, playable, src, off:ro, end:rEnd });
    sf = rEnd;
  }
}

// ============================================================
// Lazy Blob materialisation (only on user click)
// ============================================================
async function materializeBlob(asset, track, raw) {
  const fd = asset._files[track.src];
  if (!fd) return null;
  const bytes = new Uint8Array(fd.buffer);
  const slice = bytes.slice(track.off, track.end);

  if (!raw && track.code === FMT_EXT) {
    return convertWwisePcm(slice, track.ch, track.sr, track.bps);
  }
  if (!raw && track.code === FMT_VORBIS) {
    const ogg = await convertWemToOgg(slice);
    if (ogg) return ogg;
  }
  const mime = track.type==='ogg'?'audio/ogg': track.type==='wav'?'audio/wav':'application/octet-stream';
  return new Blob([slice], { type: mime });
}

function convertWwisePcm(riffBytes, ch, sr, bps) {
  const dOff = findSig(riffBytes, SIG_DATA, 0);
  if (dOff===-1) return null;
  const dv = new DataView(riffBytes.buffer, riffBytes.byteOffset+dOff);
  const dSz = dv.getUint32(4,true);
  const pcm = riffBytes.slice(dOff+8, Math.min(riffBytes.length, dOff+8+dSz));
  if (!bps) bps=16;
  const ba=ch*(bps>>3), br=sr*ba;
  const buf = new ArrayBuffer(44+pcm.length), v = new DataView(buf);
  wStr(v,0,'RIFF'); v.setUint32(4,36+pcm.length,true); wStr(v,8,'WAVE'); wStr(v,12,'fmt ');
  v.setUint32(16,16,true); v.setUint16(20,1,true); v.setUint16(22,ch,true);
  v.setUint32(24,sr,true); v.setUint32(28,br,true); v.setUint16(32,ba,true); v.setUint16(34,bps,true);
  wStr(v,36,'data'); v.setUint32(40,pcm.length,true);
  new Uint8Array(buf,44).set(pcm);
  return new Blob([buf],{type:'audio/wav'});
}

// ============================================================
// Wwise Vorbis (WEM) ‚Üí OGG Converter
// ============================================================
const _CB_B64 = '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';
let _cbLib = null;

/* Bitstream reader ‚Äì Vorbis LSB-first convention */
class VBR {
  constructor(d) { this.d = d; this.p = 0; }
  r(n) {
    let v = 0;
    for (let i = 0; i < n; i++) {
      const b = this.p++; v |= ((this.d[b >> 3] >> (b & 7)) & 1) << i;
    }
    return v;
  }
  get left() { return this.d.length * 8 - this.p; }
}

/* Bitstream writer ‚Äì Vorbis LSB-first convention */
class VBW {
  constructor() { this.b = []; this.c = 0; this.p = 0; }
  w(v, n) {
    for (let i = 0; i < n; i++) {
      if ((v >> i) & 1) this.c |= (1 << this.p);
      if (++this.p === 8) { this.b.push(this.c); this.c = 0; this.p = 0; }
    }
  }
  done() { if (this.p) this.b.push(this.c); return new Uint8Array(this.b); }
}

/* Ogg CRC-32 (polynomial 0x04c11db7) */
const _oC = new Uint32Array(256);
for (let i = 0; i < 256; i++) { let r = i << 24; for (let j = 0; j < 8; j++) r = ((r << 1) ^ ((r & 0x80000000) ? 0x04c11db7 : 0)) >>> 0; _oC[i] = r; }
function oCrc(d) { let c = 0; for (let i = 0; i < d.length; i++) c = ((c << 8) ^ _oC[((c >>> 24) ^ d[i]) & 0xFF]) >>> 0; return c; }

/* Build an Ogg page */
function oPage(ser, seq, gran, bos, eos, pkts) {
  const sg = [];
  for (const p of pkts) { let l = p.length; while (l >= 255) { sg.push(255); l -= 255; } sg.push(l); }
  const hS = 27 + sg.length, dS = pkts.reduce((s, p) => s + p.length, 0);
  const pg = new Uint8Array(hS + dS), v = new DataView(pg.buffer);
  pg[0]=0x4F; pg[1]=0x67; pg[2]=0x67; pg[3]=0x53; pg[4]=0;
  pg[5] = (bos ? 2 : 0) | (eos ? 4 : 0);
  v.setUint32(6, gran & 0xFFFFFFFF, true);
  v.setUint32(10, (gran / 0x100000000) >>> 0, true);
  v.setUint32(14, ser, true); v.setUint32(18, seq, true);
  v.setUint32(22, 0, true); pg[26] = sg.length;
  for (let i = 0; i < sg.length; i++) pg[27 + i] = sg[i];
  let o = hS; for (const p of pkts) { pg.set(p, o); o += p.length; }
  v.setUint32(22, oCrc(pg), true);
  return pg;
}

/* ilog ‚Äì bits needed to represent value */
function vilog(x) { let b = 0; while (x > 0) { b++; x >>= 1; } return b; }
/* lookup1_values for Vorbis codebook */
function vl1(e, d) { if (!e || !d) return 0; let r = Math.floor(Math.pow(e, 1 / d)); while (Math.pow(r + 1, d) <= e) r++; return r; }

/* Compute exact bit length of a packed Vorbis codebook (NO sync pattern in library) */
function cbBL(d) {
  const r = new VBR(d);
  const dm = r.r(16), en = r.r(24), ord = r.r(1);
  if (!ord) { const sp = r.r(1); for (let i = 0; i < en; i++) { if (sp) { if (r.r(1)) r.r(5); } else r.r(5); } }
  else { r.r(5); let c = 0; while (c < en) c += r.r(vilog(en - c)); }
  const lt = r.r(4);
  if (lt === 1) { r.r(32); r.r(32); const vb = r.r(4) + 1; r.r(1); const n = vl1(en, dm); for (let i = 0; i < n; i++) r.r(vb); }
  else if (lt === 2) { r.r(32); r.r(32); const vb = r.r(4) + 1; r.r(1); for (let i = 0; i < en * dm; i++) r.r(vb); }
  return r.p;
}

/* Decompress & parse the embedded codebook library */
async function _loadCB() {
  if (_cbLib) return _cbLib;
  const gz = Uint8Array.from(atob(_CB_B64), c => c.charCodeAt(0));
  const ds = new DecompressionStream('gzip');
  const wr = ds.writable.getWriter(); wr.write(gz); wr.close();
  const rd = ds.readable.getReader(); const ch = [];
  for (;;) { const { done, value } = await rd.read(); if (done) break; ch.push(value); }
  const tot = ch.reduce((s, c) => s + c.length, 0), all = new Uint8Array(tot);
  let o = 0; for (const c of ch) { all.set(c, o); o += c.length; }
  const dv = new DataView(all.buffer), rS = dv.getUint32(all.length - 4, true);
  const nO = (all.length - rS) / 4, ofs = [];
  for (let i = 0; i < nO; i++) ofs.push(dv.getUint32(rS + i * 4, true));
  const cbs = [];
  for (let i = 0; i < nO - 1; i++) cbs.push(all.slice(ofs[i], ofs[i + 1]));
  _cbLib = cbs;
  return cbs;
}

/* Parse Wwise Vorbis parameters from a WEM RIFF container */
function _parseWem(w) {
  const d = new DataView(w.buffer, w.byteOffset, w.byteLength);
  let p = 12; const ck = {};
  while (p + 8 <= w.length) {
    const id = String.fromCharCode(w[p], w[p+1], w[p+2], w[p+3]);
    const sz = d.getUint32(p + 4, true);
    ck[id] = { o: p + 8, s: sz }; p += 8 + sz + (sz & 1);
  }
  const fm = ck['fmt '], da = ck['data'];
  if (!fm || !da) return null;
  const ch = d.getUint16(fm.o + 2, true), sr = d.getUint32(fm.o + 4, true);
  const abps = d.getUint32(fm.o + 8, true);
  const cS = fm.s >= 18 ? d.getUint16(fm.o + 16, true) : 0;
  let sc, sO, aO, b0, b1;
  const vb = ck['vorb'];
  if (vb) {
    sc = d.getUint32(vb.o, true);
    if (vb.s >= 0x18) { sO = d.getUint32(vb.o + 0x10, true); aO = d.getUint32(vb.o + 0x14, true); }
    if (vb.s >= 0x2A) { b1 = w[vb.o + 0x28]; b0 = w[vb.o + 0x29]; }
  } else {
    const e = fm.o + 18;
    if (cS >= 0x30) {
      // Wwise 2021+ extended format ‚Äì 6-byte prefix shifts all standard field positions
      sc = d.getUint32(e + 0x06, true);
      sO = d.getUint32(e + 0x16, true); aO = d.getUint32(e + 0x1A, true);
      b0 = w[e + 0x2E]; b1 = w[e + 0x2F];
    } else if (cS >= 0x28) {
      // Standard extended format with blocksizes
      sc = d.getUint32(e, true);
      sO = d.getUint32(e + 0x10, true); aO = d.getUint32(e + 0x14, true);
      b1 = w[e + 0x28]; b0 = w[e + 0x29];
    } else if (cS >= 0x18) {
      // Older format ‚Äì setup/audio offsets without blocksizes
      sc = d.getUint32(e, true);
      sO = d.getUint32(e + 0x10, true); aO = d.getUint32(e + 0x14, true);
    }
  }
  if (!b0 || !b1) { b0 = 8; b1 = 11; }
  if (b0 > b1) [b0, b1] = [b1, b0];
  if (sO == null || aO == null || aO <= sO) return null;
  return { ch, sr, abps, sc, sO, aO, b0, b1, dO: da.o, dS: da.s };
}

/* Copy n bits from reader to writer */
function _cpB(r, w, n) { for (let i = 0; i < n; i++) w.w(r.r(1), 1); }

/* Convert a codebook from the packed library's COMPACT format to standard Vorbis format.
   Compact: dim(4), entries(14), [ordered|codeword_length_length(3)+sparse], lookup(1)
   Standard: BCV(24)+dim(16), entries(24), [ordered|sparse, 5-bit lengths], lookup(4)
   Reference: ww2ogg codebook_library::rebuild()                                       */
function _cbLibCopy(r, w) {
  const dm = r.r(4);  w.w(dm, 16);   // dimensions: 4‚Üí16 bits
  const en = r.r(14); w.w(en, 24);   // entries: 14‚Üí24 bits
  const ord = r.r(1); w.w(ord, 1);
  if (ord) {
    _cpB(r, w, 5); // initial_length
    let c = 0;
    while (c < en) { const nb = vilog(en - c); const num = r.r(nb); w.w(num, nb); c += num; }
  } else {
    // IN: 3-bit codeword_length_length (compact only, not in standard Vorbis)
    const cll = r.r(3);
    const sp = r.r(1); w.w(sp, 1);   // sparse flag: same in both formats
    for (let i = 0; i < en; i++) {
      if (sp) {
        const fl = r.r(1); w.w(fl, 1);
        if (fl) { const cl = r.r(cll); w.w(cl, 5); } // IN: cll bits ‚Üí OUT: 5 bits
      } else {
        const cl = r.r(cll); w.w(cl, 5);             // IN: cll bits ‚Üí OUT: 5 bits
      }
    }
  }
  const lt = r.r(1); w.w(lt, 4);    // lookup_type: 1‚Üí4 bits
  if (lt === 1) {
    _cpB(r, w, 32); _cpB(r, w, 32); // min_value, delta_value
    const vb = r.r(4); w.w(vb, 4);  // value_bits
    _cpB(r, w, 1);                   // sequence_p
    const qv = vl1(en, dm);
    for (let i = 0; i < qv; i++) _cpB(r, w, vb + 1);
  }
}

/* Rebuild Vorbis setup header from Wwise modified setup packet + external codebooks.
   Reference: ww2ogg Wwise_RIFF_Vorbis::generate_ogg_header() (wwriff.cpp)
   Key differences from standard Vorbis setup:
   - Time domain section: NOT in Wwise data, write fixed placeholder
   - Floor type: NOT in Wwise data, always write 1
   - Residue type: 2 bits in Wwise ‚Üí 16 bits standard
   - Mapping type: NOT in Wwise data, always write 0
   - Mode windowtype/transformtype: NOT in Wwise data, write 0,0          */
function _rebuildSetup(raw, lib, nch) {
  const r = new VBR(raw), w = new VBW();
  // Vorbis header prefix: type 5 + "vorbis"
  w.w(5, 8); for (const c of [0x76,0x6F,0x72,0x62,0x69,0x73]) w.w(c, 8);
  // Codebooks ‚Äì replace 10-bit library indices with actual codebook data
  const cbc = r.r(8); w.w(cbc, 8);
  for (let i = 0; i <= cbc; i++) {
    const idx = r.r(10);
    if (idx >= lib.length) return null;
    w.w(0x564342, 24);                     // BCV sync pattern
    _cbLibCopy(new VBR(lib[idx]), w);       // compact ‚Üí standard Vorbis
  }
  // Time domain: NOT in Wwise data ‚Äì write fixed placeholder
  w.w(0, 6);   // time_count_less1 = 0  ‚Üí  1 entry
  w.w(0, 16);  // time type 0
  // Floors ‚Äì floor type NOT in Wwise data, always type 1
  const fc = r.r(6); w.w(fc, 6);
  for (let i = 0; i <= fc; i++) {
    w.w(1, 16);  // floor type = 1 (not read from input)
    const np = r.r(5); w.w(np, 5);
    let mx = -1; const pc = [];
    for (let j = 0; j < np; j++) { const c = r.r(4); pc.push(c); w.w(c, 4); if (c > mx) mx = c; }
    const cd = [];
    for (let j = 0; j <= mx; j++) {
      const dm = r.r(3) + 1; cd.push(dm); w.w(dm - 1, 3);
      const sb = r.r(2); w.w(sb, 2);
      if (sb) _cpB(r, w, 8);
      for (let k = 0; k < (1 << sb); k++) _cpB(r, w, 8);
    }
    _cpB(r, w, 2); const rb = r.r(4); w.w(rb, 4);
    let fv = 2; for (let j = 0; j < np; j++) fv += cd[pc[j]];
    for (let j = 2; j < fv; j++) _cpB(r, w, rb);
  }
  // Residues ‚Äì type is 2 bits in Wwise ‚Üí 16 bits standard
  const rc = r.r(6); w.w(rc, 6);
  for (let i = 0; i <= rc; i++) {
    const rt = r.r(2); w.w(rt, 16);   // 2 bits in ‚Üí 16 bits out
    _cpB(r, w, 24); _cpB(r, w, 24); _cpB(r, w, 24);
    const cls = r.r(6) + 1; w.w(cls - 1, 6); _cpB(r, w, 8);
    const cas = [];
    for (let j = 0; j < cls; j++) {
      const lo = r.r(3); w.w(lo, 3); const bf = r.r(1); w.w(bf, 1);
      let hi = 0; if (bf) { hi = r.r(5); w.w(hi, 5); }
      cas.push(lo | (hi << 3));
    }
    for (let j = 0; j < cls; j++) for (let k = 0; k < 8; k++) if (cas[j] & (1 << k)) _cpB(r, w, 8);
  }
  // Mappings ‚Äì type NOT in Wwise data, always type 0
  const mc = r.r(6); w.w(mc, 6);
  for (let i = 0; i <= mc; i++) {
    w.w(0, 16);  // mapping type = 0 (not read from input)
    let sm = 1;
    const sf = r.r(1); w.w(sf, 1); if (sf) { sm = r.r(4) + 1; w.w(sm - 1, 4); }
    const cf = r.r(1); w.w(cf, 1);
    if (cf) { const cs = r.r(8) + 1; w.w(cs - 1, 8); const cb = vilog(nch - 1); for (let j = 0; j < cs; j++) { _cpB(r, w, cb); _cpB(r, w, cb); } }
    _cpB(r, w, 2);
    if (sm > 1) for (let j = 0; j < nch; j++) _cpB(r, w, 4);
    for (let j = 0; j < sm; j++) { _cpB(r, w, 8); _cpB(r, w, 8); _cpB(r, w, 8); }
  }
  // Modes ‚Äì windowtype/transformtype NOT in Wwise data
  const modc = r.r(6); w.w(modc, 6);
  const mbf = [];
  for (let i = 0; i <= modc; i++) {
    const bf = r.r(1); mbf.push(bf); w.w(bf, 1);
    w.w(0, 16); w.w(0, 16);  // windowtype=0, transformtype=0 (not in input)
    _cpB(r, w, 8);            // mapping number
  }
  w.w(1, 1); // framing bit
  return { hdr: w.done(), mbf, mc: modc + 1 };
}

/* Build standard Vorbis identification header */
function _vorbisId(ch, sr, abps, b0, b1) {
  const u = new Uint8Array(30), v = new DataView(u.buffer);
  u[0] = 1; u.set([0x76,0x6F,0x72,0x62,0x69,0x73], 1);
  v.setUint32(7, 0, true); u[11] = ch;
  v.setUint32(12, sr, true); v.setInt32(16, 0, true);
  v.setInt32(20, abps * 8, true); v.setInt32(24, 0, true);
  u[28] = b0 | (b1 << 4); u[29] = 1;
  return u;
}

/* Build Vorbis comment header */
function _vorbisComment() {
  const vn = 'uextract', u = new Uint8Array(7 + 4 + vn.length + 4 + 1);
  const v = new DataView(u.buffer);
  u[0] = 3; u.set([0x76,0x6F,0x72,0x62,0x69,0x73], 1);
  v.setUint32(7, vn.length, true);
  for (let i = 0; i < vn.length; i++) u[11 + i] = vn.charCodeAt(i);
  v.setUint32(11 + vn.length, 0, true); u[15 + vn.length] = 1;
  return u;
}

/* Main converter: WEM (Wwise Vorbis) ‚Üí OGG Blob */
async function convertWemToOgg(wem) {
  try {
    const p = _parseWem(wem);
    if (!p) return null;
    const lib = await _loadCB();
    // Rebuild setup header from Wwise setup packet + external codebooks
    // Setup packet has a 2-byte LE size prefix (same as audio packets)
    const setupRaw = wem.slice(p.dO + p.sO + 2, p.dO + p.aO);
    const setup = _rebuildSetup(setupRaw, lib, p.ch);
    if (!setup) return null;
    // Verify setup header starts with type 5 + "vorbis"
    const sh = setup.hdr;
    if (sh[0]!==5||sh[1]!==0x76||sh[2]!==0x6F||sh[3]!==0x72||sh[4]!==0x62||sh[5]!==0x69||sh[6]!==0x73)
      return null;
    // Build ID header
    const idHdr = _vorbisId(p.ch, p.sr, p.abps, p.b0, p.b1);
    // Ogg header pages
    const ser = (Math.random() * 0xFFFFFFFF) >>> 0;
    let seq = 0;
    const pages = [
      oPage(ser, seq++, 0, true, false, [idHdr]),
      oPage(ser, seq++, 0, false, false, [_vorbisComment()]),
      oPage(ser, seq++, 0, false, false, [setup.hdr])
    ];
    // Process audio packets (TYPE_2: 2-byte size prefix, MODIFIED: first-byte rebuild)
    const dv = new DataView(wem.buffer, wem.byteOffset, wem.byteLength);
    let pos = p.dO + p.aO;
    const dEnd = p.dO + Math.min(p.dS, wem.length - p.dO);
    const mBits = vilog(setup.mc - 1);
    const bs0 = 1 << p.b0, bs1 = 1 << p.b1;
    let prevBS = 0, gran = 0, pgPkts = [], pgSz = 0;
    while (pos + 2 <= dEnd) {
      const pSz = dv.getUint16(pos, true); pos += 2;
      if (!pSz || pos + pSz > dEnd) break;
      const pkt = wem.slice(pos, pos + pSz); pos += pSz;
      // Determine mode & blocksize for granule tracking
      const iR = new VBR(pkt);
      const mode = mBits > 0 ? iR.r(mBits) : 0;
      const curBS = setup.mbf[mode] ? bs1 : bs0;
      if (prevBS) gran += (prevBS + curBS) / 4;
      prevBS = curBS;
      // Rebuild: prepend packet_type bit, add window flags for long blocks
      const oW = new VBW();
      oW.w(0, 1);
      if (mBits > 0) oW.w(mode, mBits);
      if (setup.mbf[mode]) { oW.w(0, 1); oW.w(0, 1); }
      while (iR.left > 0) { const n = Math.min(8, iR.left); oW.w(iR.r(n), n); }
      const rebuilt = oW.done();
      pgPkts.push(rebuilt);
      pgSz += pSz;
      if (pgSz >= 4000 || pos + 2 > dEnd) {
        const last = pos + 2 > dEnd;
        pages.push(oPage(ser, seq++, last && p.sc ? p.sc : gran, false, last, pgPkts));
        pgPkts = []; pgSz = 0;
      }
    }
    if (pgPkts.length) pages.push(oPage(ser, seq++, p.sc || gran, false, true, pgPkts));
    // Concatenate all pages into final OGG
    const tot = pages.reduce((s, pg) => s + pg.length, 0), ogg = new Uint8Array(tot);
    let o = 0; for (const pg of pages) { ogg.set(pg, o); o += pg.length; }
    return new Blob([ogg], { type: 'audio/ogg' });
  } catch (e) {
    return null;
  }
}

// ============================================================
// Asset tags (for filtering)
// ============================================================
function assetTags(a) {
  const t = new Set();
  if (a.tracks.some(x=>x.playable)) t.add('audio');
  if (a.dlgLines.length || a.meta.type.startsWith('Dlg') || a.meta.type === 'DialogueWave') t.add('dialogue');
  if (a.tracks.some(x=>!x.playable)) t.add('wwise');
  if (!t.size) t.add('data');
  return t;
}

function primaryTag(a) {
  if (a.tracks.some(x=>x.playable)) return 'audio';
  if (a.dlgLines.length) return 'dialogue';
  if (a.tracks.some(x=>!x.playable)) return 'wwise';
  return 'data';
}

// ============================================================
// File Tree
// ============================================================
function buildFileTree(pkgs) {
  fileTree = { name:'root', children:{}, type:'folder' };
  for (const [,pkg] of Object.entries(pkgs)) {
    const parts = pkg.path.split(/[\/\\]/).filter(Boolean);
    let cur = fileTree;
    for (const p of parts) {
      if (!cur.children[p]) cur.children[p] = { name:p, children:{}, type:'folder' };
      cur = cur.children[p];
    }
    cur.children[pkg.name] = { name:pkg.name, type:'file', pkg };
  }
}

function renderFileTree() {
  treeItemEls = [];
  const frag = document.createDocumentFragment();
  renderNode(fileTree, frag, 0);
  treeContainer.innerHTML = '';
  treeContainer.appendChild(frag);
  applyFilter();
}

function renderNode(node, container, depth) {
  if (node.type === 'folder' && node.name !== 'root') {
    const div = document.createElement('div');
    div.className = 'tree-folder';
    const hdr = document.createElement('div');
    hdr.className = 'tree-folder-header';
    hdr.style.paddingLeft = (depth*6+4)+'px';
    hdr.innerHTML = '<span class="chevron">‚ñº</span> <span>üìÅ</span> ' + esc(node.name);
    const kids = document.createElement('div');
    kids.className = 'tree-folder-children';
    hdr.addEventListener('click', () => { hdr.classList.toggle('collapsed'); kids.classList.toggle('hidden'); });
    div.appendChild(hdr); div.appendChild(kids); container.appendChild(div);
    div._folderKidsEl = kids;
    const sorted = Object.values(node.children).sort((a,b) => { if (a.type!==b.type) return a.type==='folder'?-1:1; return a.name.localeCompare(b.name); });
    for (const c of sorted) renderNode(c, kids, depth+1);
  } else if (node.type === 'file') {
    const asset = allAssets.find(a => a.fullPath === node.pkg?.fullPath);
    if (!asset) return;
    const tag = primaryTag(asset);
    const icons = { audio:'üîä', dialogue:'üí¨', wwise:'üî∂', data:'üìÑ' };
    const badgeCls = { audio:'tb-audio', dialogue:'tb-dlg', wwise:'tb-wem', data:'' };
    const item = document.createElement('div');
    item.className = 'tree-item';
    item.style.paddingLeft = ((depth+1)*6+4)+'px';
    const resolved = resolveMediaName(node.name);
    const displayName = resolved || node.name;
    const titleText = resolved ? esc(node.name) + ' ‚Üí ' + esc(resolved) : esc(node.name);
    item.innerHTML = '<span class="icon">' + (icons[tag]||'üìÑ') + '</span>' +
      '<span class="name" title="' + titleText + '">' + esc(displayName) +
        (resolved ? '<span class="dlg-resolved">' + esc(node.name) + '</span>' : '') +
      '</span>' +
      '<span class="type-badge ' + (badgeCls[tag]||'') + '">' + tag + '</span>';
    item._asset = asset;
    item._tags = assetTags(asset);
    item.addEventListener('click', () => selectAsset(asset, item));
    container.appendChild(item);
    treeItemEls.push(item);
  } else if (node.name === 'root') {
    const sorted = Object.values(node.children).sort((a,b) => { if (a.type!==b.type) return a.type==='folder'?-1:1; return a.name.localeCompare(b.name); });
    for (const c of sorted) renderNode(c, container, depth);
  }
}

function applyFilter() {
  const searchTerm = ($('searchInput')?.value || '').toLowerCase().trim();
  // Dialogue filter: switch to dialogue tree view
  if (currentFilter === 'dialogue' && Object.keys(crossRef.dialogueData).length > 0) {
    if (!fileTreeFrag) {
      fileTreeFrag = document.createDocumentFragment();
      while (treeContainer.firstChild) fileTreeFrag.appendChild(treeContainer.firstChild);
    }
    treeContainer.innerHTML = '';
    treeContainer.appendChild(renderDialogueTree(searchTerm));
    return;
  }
  // Restore file tree if coming from dialogue view
  if (fileTreeFrag) {
    treeContainer.innerHTML = '';
    treeContainer.appendChild(fileTreeFrag);
    fileTreeFrag = null;
  }
  for (const el of treeItemEls) {
    const matchFilter = currentFilter === 'all' || el._tags.has(currentFilter);
    const matchSearch = !searchTerm || (el._asset && (
      el._asset.name.toLowerCase().includes(searchTerm) ||
      (resolveMediaName(el._asset.name) || '').toLowerCase().includes(searchTerm) ||
      el._asset.path.toLowerCase().includes(searchTerm)
    ));
    el.classList.toggle('filtered-out', !(matchFilter && matchSearch));
  }
  // Hide empty folders ‚Äì process bottom-up so inner empties are hidden before parents check
  const folders = Array.from(treeContainer.querySelectorAll('.tree-folder')).reverse();
  for (const folder of folders) {
    const kids = folder.querySelector('.tree-folder-children');
    if (!kids) { folder.classList.add('filtered-out'); continue; }
    const hasVisible = kids.querySelector('.tree-item:not(.filtered-out), .tree-folder:not(.filtered-out)');
    folder.classList.toggle('filtered-out', !hasVisible);
  }
  // Update visible count
  const visibleCount = treeItemEls.filter(el => !el.classList.contains('filtered-out')).length;
  const total = treeItemEls.length;
  fileCountEl.textContent = (searchTerm || currentFilter !== 'all') ? visibleCount + ' / ' + total : total;
}

// ============================================================
// Detail Panel (lazy render on click)
// ============================================================
function selectAsset(asset, treeEl) {
  // Highlight in tree
  treeContainer.querySelectorAll('.tree-item.active').forEach(e => e.classList.remove('active'));
  if (treeEl) treeEl.classList.add('active');
  selectedAsset = asset;

  // Free previous blob
  if (activeBlobUrl) { URL.revokeObjectURL(activeBlobUrl); activeBlobUrl = null; }

  detailPanel.style.display = '';
  detailPanel.scrollTop = 0;

  const tags = assetTags(asset);
  let tagHtml = '';
  for (const t of tags) {
    const cls = { audio:'type-ogg', dialogue:'type-dlg', wwise:'type-wem', data:'' }[t] || '';
    tagHtml += '<span class="meta-tag ' + cls + '">' + t + '</span>';
  }

  let html = '<div class="detail-header">' +
    '<div class="detail-name">' + esc(asset.name) + '</div>' +
    '<div class="detail-path">' + esc(asset.path || '/') + '</div>' +
    '<div class="detail-tags">' + tagHtml +
      '<span class="meta-tag">' + esc(asset.meta.type) + '</span>' +
    '</div></div>';

  // Stats
  html += '<div class="stats-bar">' +
    (asset.tracks.length ? '<div class="stat"><span class="stat-value">' + asset.tracks.length + '</span><span class="stat-label">tracks</span></div>' : '') +
    (asset.dlgLines.length ? '<div class="stat"><span class="stat-value">' + asset.dlgLines.length + '</span><span class="stat-label">lines</span></div>' : '') +
    '<div class="stat"><span class="stat-value">' + (asset._files.uasset?'‚úì':'‚Äî') + '</span><span class="stat-label">.uasset</span></div>' +
    '<div class="stat"><span class="stat-value">' + (asset._files.uexp?'‚úì':'‚Äî') + '</span><span class="stat-label">.uexp</span></div>' +
    '<div class="stat"><span class="stat-value">' + (asset._files.ubulk?'‚úì':'‚Äî') + '</span><span class="stat-label">.ubulk</span></div>' +
    '</div>';

  // Audio tracks
  if (asset.tracks.length) {
    html += '<div class="detail-section"><div class="detail-section-title">Audio Tracks</div>';
    asset.tracks.forEach((tr, i) => {
      const sizeKB = ((tr.end - tr.off) / 1024).toFixed(1);
      const tcls = tr.type==='ogg'?'type-ogg':tr.type==='wav'?'type-wav':'type-wem';
      html += '<div class="track-row" data-track="'+i+'">' +
        '<div class="track-meta">' +
          '<span class="meta-tag '+tcls+'">'+esc(tr.format)+'</span>' +
          '<span class="meta-tag">'+sizeKB+' KB</span>' +
          (tr.ch ? '<span class="meta-tag">'+tr.ch+'ch</span>' : '') +
          (tr.sr ? '<span class="meta-tag">'+tr.sr+' Hz</span>' : '') +
        '</div>';
      if (tr.playable) {
        html += '<div class="track-player" id="tp'+i+'"></div>' +
          '<div class="track-actions">' +
            '<button class="btn btn-primary play-btn" data-idx="'+i+'">‚ñ∂ Play</button>' +
            '<button class="btn btn-secondary dlogg-btn" data-idx="'+i+'">üíæ OGG</button>' +
            '<button class="btn btn-secondary dlwav-btn" data-idx="'+i+'">üíæ WAV</button>' +
          '</div>';
      } else {
        html += '<div class="wwise-notice">‚ö†Ô∏è '+esc(tr.format)+' ‚Äî download as .wem, convert with vgmstream / ww2ogg</div>' +
          '<div class="track-actions"><button class="btn btn-secondary dl-btn" data-idx="'+i+'" data-ext=".wem">üíæ WEM</button></div>';
      }
      html += '</div>';
    });
    html += '</div>';
  }

  // Dialogue
  if (asset.dlgLines.length) {
    html += '<div class="detail-section"><div class="detail-section-title">Dialogue</div>' +
      '<div class="dialogue-lines">' + asset.dlgLines.map(l => '<div class="dialogue-line">'+esc(l)+'</div>').join('') + '</div>' +
      '<div style="margin-top:6px"><button class="btn btn-secondary copy-dlg-btn">üìã Copy All</button></div>' +
      '</div>';
  }

  detailPanel.innerHTML = html;

  // Wire up events via delegation
  detailPanel.addEventListener('click', onDetailClick);
}

async function onDetailClick(e) {
  const btn = e.target.closest('button');
  if (!btn || !selectedAsset) return;

  if (btn.classList.contains('play-btn')) {
    const idx = +btn.dataset.idx;
    const tr = selectedAsset.tracks[idx];
    const container = $('tp' + idx);
    if (!container) return;

    // Lazy: create audio element on first play
    if (!container.querySelector('audio')) {
      const blob = await materializeBlob(selectedAsset, tr);
      if (!blob) return;
      if (activeBlobUrl) URL.revokeObjectURL(activeBlobUrl);
      activeBlobUrl = URL.createObjectURL(blob);
      container.innerHTML = '<audio controls autoplay style="width:100%;height:32px;border-radius:6px;outline:none" src="'+activeBlobUrl+'"></audio>';
      btn.textContent = '‚è∏ Pause';
    } else {
      const audio = container.querySelector('audio');
      if (audio.paused) { audio.play(); btn.textContent = '‚è∏ Pause'; }
      else { audio.pause(); btn.textContent = '‚ñ∂ Play'; }
    }
  }

  else if (btn.classList.contains('dl-btn')) {
    const idx = +btn.dataset.idx;
    const ext = btn.dataset.ext;
    const tr = selectedAsset.tracks[idx];
    const blob = await materializeBlob(selectedAsset, tr);
    if (blob) downloadBlob(getDownloadName(selectedAsset), blob, ext, idx);
  }

  else if (btn.classList.contains('dlogg-btn')) {
    const idx = +btn.dataset.idx;
    const tr = selectedAsset.tracks[idx];
    handleOggDl(btn, getDownloadName(selectedAsset), selectedAsset, tr, idx);
  }

  else if (btn.classList.contains('dlwav-btn')) {
    const idx = +btn.dataset.idx;
    const tr = selectedAsset.tracks[idx];
    handleWavDl(btn, getDownloadName(selectedAsset), selectedAsset, tr, idx);
  }

  else if (btn.classList.contains('copy-dlg-btn')) {
    navigator.clipboard.writeText(selectedAsset.dlgLines.join('\n\n'));
    btn.textContent = '‚úì Copied!';
    setTimeout(() => { btn.textContent = 'üìã Copy All'; }, 1200);
  }
}

function showDetailEmpty() {
  detailPanel.style.display = '';
  detailPanel.innerHTML = '<div class="detail-empty"><div class="de-icon">üëà</div><p>Select a file from the tree to preview</p></div>';
}

// ============================================================
// Downloads
// ============================================================
function downloadBlob(name, blob, ext, idx) {
  const fn = sanitize(name) + (idx > 0 ? '_'+(idx+1) : '') + ext;
  const a = document.createElement('a');
  const u = URL.createObjectURL(blob);
  a.href = u; a.download = fn; a.click();
  URL.revokeObjectURL(u);
}

async function handleWavDl(btn, name, asset, track, idx) {
  btn.disabled = true; btn.innerHTML = '<span class="spinner" style="width:12px;height:12px;border-width:2px"></span>';
  try {
    const blob = await materializeBlob(asset, track);
    if (!blob) throw new Error('No data');
    if (track.type === 'wav') { downloadBlob(name, blob, '.wav', idx); }
    else {
      const ctx = new (window.AudioContext || window.webkitAudioContext)();
      const ab = await blob.arrayBuffer();
      const dec = await ctx.decodeAudioData(ab);
      downloadBlob(name, abToWav(dec), '.wav', idx);
      ctx.close();
    }
  } catch (err) { alert('WAV conversion failed.'); }
  btn.disabled = false; btn.textContent = 'üíæ WAV';
}

async function handleOggDl(btn, name, asset, track, idx) {
  btn.disabled = true; btn.innerHTML = '<span class="spinner" style="width:12px;height:12px;border-width:2px"></span>';
  try {
    const blob = await materializeBlob(asset, track);
    if (!blob) throw new Error('No data');
    if (blob.type === 'audio/ogg') {
      downloadBlob(name, blob, '.ogg', idx);
    } else {
      // WAV track ‚Äì try converting to OGG via MediaRecorder, fall back to WAV decode‚ÜíOGG
      const oggBlob = await wavToOgg(blob);
      if (oggBlob) downloadBlob(name, oggBlob, '.ogg', idx);
      else {
        // Fallback: decode and re-encode as WAV (browser doesn't support OGG encoding)
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const ab = await blob.arrayBuffer();
        const dec = await ctx.decodeAudioData(ab);
        downloadBlob(name, abToWav(dec), '.wav', idx);
        ctx.close();
      }
    }
  } catch (err) { alert('OGG conversion failed.'); }
  btn.disabled = false; btn.textContent = 'üíæ OGG';
}

async function wavToOgg(wavBlob) {
  const mime = MediaRecorder.isTypeSupported('audio/ogg; codecs=opus') ? 'audio/ogg; codecs=opus' :
               MediaRecorder.isTypeSupported('audio/ogg') ? 'audio/ogg' : null;
  if (!mime) return null;
  const ctx = new (window.AudioContext || window.webkitAudioContext)();
  try {
    const ab = await wavBlob.arrayBuffer();
    const audioBuf = await ctx.decodeAudioData(ab);
    const dest = ctx.createMediaStreamDestination();
    const src = ctx.createBufferSource();
    src.buffer = audioBuf;
    src.connect(dest);
    return await new Promise(resolve => {
      const rec = new MediaRecorder(dest.stream, { mimeType: mime });
      const chunks = [];
      rec.ondataavailable = e => { if (e.data.size) chunks.push(e.data); };
      rec.onstop = () => resolve(new Blob(chunks, { type: 'audio/ogg' }));
      rec.start();
      src.start();
      src.onended = () => setTimeout(() => rec.stop(), 100);
    });
  } catch (e) { return null; }
  finally { ctx.close(); }
}

function abToWav(ab) {
  const nCh=ab.numberOfChannels, sr=ab.sampleRate, len=ab.length*nCh;
  const smp = new Float32Array(len);
  for (let c=0;c<nCh;c++){const d=ab.getChannelData(c);for(let i=0;i<ab.length;i++)smp[i*nCh+c]=d[i];}
  const buf=new ArrayBuffer(44+len*2), v=new DataView(buf), ba=nCh*2;
  wStr(v,0,'RIFF');v.setUint32(4,36+len*2,true);wStr(v,8,'WAVE');wStr(v,12,'fmt ');
  v.setUint32(16,16,true);v.setUint16(20,1,true);v.setUint16(22,nCh,true);
  v.setUint32(24,sr,true);v.setUint32(28,sr*ba,true);v.setUint16(32,ba,true);v.setUint16(34,16,true);
  wStr(v,36,'data');v.setUint32(40,len*2,true);
  let o=44;for(let i=0;i<len;i++){const s=Math.max(-1,Math.min(1,smp[i]));v.setInt16(o,s<0?s*0x8000:s*0x7FFF,true);o+=2;}
  return new Blob([buf],{type:'audio/wav'});
}

async function downloadAllAudio(fmt) {
  const btn = fmt==='ogg'?downloadAllOggBtn:downloadAllWavBtn;
  const orig = btn.innerHTML; btn.disabled = true;
  const tracks = [];
  for (const a of allAssets) for (let i=0;i<a.tracks.length;i++) if (a.tracks[i].playable) tracks.push({asset:a, track:a.tracks[i], idx:i});
  for (let i=0;i<tracks.length;i++) {
    btn.innerHTML = '<span class="spinner" style="width:12px;height:12px;border-width:2px"></span> '+(i+1)+'/'+tracks.length;
    const t=tracks[i];
    const dlName = getDownloadName(t.asset);
    if (fmt==='wav') {
      try { await handleWavDl(btn, dlName, t.asset, t.track, t.idx); } catch(e) {}
    } else {
      // OGG: materialize and download as OGG where possible, WAV otherwise
      const blob = await materializeBlob(t.asset, t.track);
      if (!blob) continue;
      if (blob.type === 'audio/ogg') downloadBlob(dlName, blob, '.ogg', t.idx);
      else downloadBlob(dlName, blob, '.wav', t.idx);
    }
    await new Promise(r=>setTimeout(r, 120));
  }
  btn.disabled=false; btn.innerHTML=orig;
}

// ============================================================
// Metadata / Helpers
// ============================================================
function parseUAssetMeta(buf) {
  const text = extractStr(new Uint8Array(buf));
  const m = { type:'Unknown', assetName:null, format:null };
  // Most reliable: check Default__ClassName (only exists for the asset's own type, not imports)
  const dm = [['Default__DlgDialogue','DlgDialogue'],['Default__DlgNode_Speech','DlgDialogue'],
    ['Default__DialogueWave','DialogueWave'],['Default__AkAudioEvent','Wwise Event'],
    ['Default__AkMediaAsset','Wwise Media'],['Default__AkAudioEventData','Wwise Event'],
    ['Default__SoundWave','SoundWave'],['Default__SoundCue','SoundCue']];
  for (const [k,t] of dm) if (text.includes(k)){m.type=t;break;}
  // Fallback: class name matching (Dlg types first to avoid AkAudioEvent shadow)
  if (m.type === 'Unknown') {
    const tm = [['DlgDialogue','DlgDialogue'],['DlgNode_Speech','DlgDialogue'],
      ['DialogueWave','DialogueWave'],['DialogueVoice','DialogueVoice'],
      ['SoundWave','SoundWave'],['SoundCue','SoundCue'],
      ['SoundClass','SoundClass'],['SoundMix','SoundMix'],
      ['SoundAttenuation','Attenuation'],['SoundConcurrency','Concurrency'],
      ['AkAudioEvent','Wwise Event'],['AkMediaAsset','Wwise Media']];
    for (const [k,t] of tm) if (text.includes(k)){m.type=t;break;}
  }
  if (/OGG\d+/.test(text)) m.format='OGG';
  if (/WAV|PCM/i.test(text)) m.format='WAV';
  const pm=text.match(/\/Game\/[^\/]+\/[^\x00]+/);
  if (pm) m.assetName=pm[0].split('/').pop().replace(/\x00/g,'');
  return m;
}

function extractStr(bytes, ml=4) {
  const p=[]; let c='';
  for (let i=0;i<bytes.length;i++){const b=bytes[i];if(b>=32&&b<127)c+=String.fromCharCode(b);else{if(c.length>=ml)p.push(c);c='';}}
  if(c.length>=ml)p.push(c); return p.join('\n');
}

function extractDlgText(bytes) {
  const lines = [], seen = new Set();
  // Pass 1: ASCII strings
  let cur = '';
  for (let i = 0; i < bytes.length; i++) {
    const c = bytes[i];
    if (c >= 32 && c < 127) cur += String.fromCharCode(c);
    else { addDlgLine(cur, lines, seen); cur = ''; }
  }
  addDlgLine(cur, lines, seen);
  // Pass 2: UTF-16LE strings (detect [printable][0x00] pairs)
  cur = '';
  for (let i = 0; i < bytes.length - 1; i++) {
    const lo = bytes[i], hi = bytes[i + 1];
    if (hi === 0 && lo >= 32 && lo < 127) { cur += String.fromCharCode(lo); i++; }
    else { addDlgLine(cur, lines, seen); cur = ''; }
  }
  addDlgLine(cur, lines, seen);
  return lines;
}
function addDlgLine(raw, lines, seen) {
  const t = raw.trim();
  if (t.length < 10 || seen.has(t)) return;
  if (!/\s/.test(t)) return;                     // natural language has spaces
  if (/^[{\/]/.test(t)) return;                   // paths & context hashes
  if (/Property$|^Default__|^None$|^Class$/i.test(t)) return;
  if (/^[0-9A-Fa-f]{32}$/.test(t.replace(/\s/g, ''))) return;
  seen.add(t); lines.push(t);
}

// ============================================================
// Cross-Reference: Event‚ÜíMedia, Dialogue‚ÜíEvents
// ============================================================
function extractAssetRefs(buffer) {
  const text = extractStr(new Uint8Array(buffer));
  const refs = { events: [], media: [], character: null };
  for (const line of text.split('\n')) {
    const mm = line.match(/WwiseAudio\/(?:Localized\/[^\/]+\/)?Media\/(\d+)/);
    if (mm) { const id = mm[1]; if (!refs.media.includes(id)) refs.media.push(id); }
    const em = line.match(/WwiseAudio\/(?:Localized\/[^\/]+\/)?Events\/.*\/([A-Za-z_]\w+)/);
    if (em) { const n = em[1]; if (n.length > 3 && !refs.events.includes(n)) refs.events.push(n); }
    const cm = line.match(/Contact_UMC_(\w+)/);
    if (cm && !refs.character) refs.character = cm[1];
  }
  return refs;
}

function buildCrossRef() {
  crossRef = { eventToMedia: {}, mediaToEvent: {}, dialogueData: {}, mediaToDialogue: {}, assetByName: {} };
  // Lookup map for all assets by name
  for (const a of allAssets) crossRef.assetByName[a.name] = a;
  // Pass 1: Event ‚Üí Media mapping (from assets that reference media files)
  for (const asset of allAssets) {
    if (!asset.refs || !asset.refs.media.length) continue;
    crossRef.eventToMedia[asset.name] = asset.refs.media;
    // Also index by the actual Wwise event names found inside the asset,
    // since the package filename often differs from the event name
    // (e.g. file "Play_VO_HUB_C1_HERRERA_10_11" contains event "Play_VO_HUB_C1_HERRERA_10")
    for (const evtName of (asset.refs.events || [])) {
      if (!crossRef.eventToMedia[evtName]) {
        crossRef.eventToMedia[evtName] = [];
      }
      for (const mid of asset.refs.media) {
        if (!crossRef.eventToMedia[evtName].includes(mid)) {
          crossRef.eventToMedia[evtName].push(mid);
        }
      }
    }
    for (const mid of asset.refs.media) {
      if (!crossRef.mediaToEvent[mid]) crossRef.mediaToEvent[mid] = [];
      // Add actual event names first for better display in resolveMediaName
      for (const evtName of (asset.refs.events || [])) {
        if (!crossRef.mediaToEvent[mid].includes(evtName)) crossRef.mediaToEvent[mid].push(evtName);
      }
      // Don't add numeric asset names (e.g. audio package named by media ID) as display name
      if (!/^\d+$/.test(asset.name) && !crossRef.mediaToEvent[mid].includes(asset.name))
        crossRef.mediaToEvent[mid].push(asset.name);
    }
  }
  // Pass 2: Dialogue data (from dialogue-type assets)
  for (const asset of allAssets) {
    if (!asset.refs) continue;
    const isDlg = asset.meta.type.startsWith('Dlg') || asset.meta.type === 'DialogueWave';
    if (!isDlg) continue;
    const character = asset.refs.character || guessCharacter(asset.name);
    crossRef.dialogueData[asset.name] = { character, events: asset.refs.events, text: asset.dlgLines, asset };
  }
  // Pass 3: Media ‚Üí Dialogue mapping
  for (const [, data] of Object.entries(crossRef.dialogueData)) {
    for (const evtName of data.events) {
      const mediaIds = crossRef.eventToMedia[evtName];
      if (mediaIds) {
        for (const mid of mediaIds) {
          crossRef.mediaToDialogue[mid] = { dialogue: data.asset.name, event: evtName, character: data.character };
        }
      }
    }
  }
}

function guessCharacter(name) {
  const s = name.replace(/^Dlg_?/, '');
  const parts = s.split('_').filter(Boolean);
  if (!parts.length) return name;
  const skip = /^(?:FT|C\d+|M\d+|Intro|Wrap|Debrief|Final|Default|Copy|Dummy)$/i;
  for (let i = parts.length - 1; i >= 0; i--) { if (!skip.test(parts[i])) return parts[i]; }
  return parts[parts.length - 1];
}

function resolveMediaName(name) {
  if (!/^\d+$/.test(name) || !crossRef.mediaToEvent[name] || !crossRef.mediaToEvent[name].length)
    return null;
  // Prefer first non-numeric entry (event name) so we don't "resolve" to the same media ID
  const arr = crossRef.mediaToEvent[name];
  for (let i = 0; i < arr.length; i++) {
    if (!/^\d+$/.test(arr[i])) return arr[i];
  }
  return null;
}

function getDownloadName(asset) {
  const name = asset.name;
  // Resolve the event name from cross-reference or the asset's own refs
  let eventName = resolveMediaName(name);
  if (!eventName && asset.refs && asset.refs.events && asset.refs.events.length) {
    eventName = asset.refs.events[0];
  }
  // Check dialogue cross-reference ‚Äî prefix dialogue name if available
  const dlgInfo = crossRef.mediaToDialogue[name];
  if (dlgInfo && dlgInfo.dialogue) {
    const base = eventName || name;
    // Avoid duplicating if dialogue name is already part of the event name
    if (base.includes(dlgInfo.dialogue)) return base;
    return dlgInfo.dialogue + '__' + base;
  }
  return eventName || name;
}

// ============================================================
// Dialogue Tree (alternative sidebar view)
// ============================================================
function renderDialogueTree(searchTerm) {
  const frag = document.createDocumentFragment();
  const byChar = {};
  for (const [name, data] of Object.entries(crossRef.dialogueData)) {
    const ch = data.character;
    if (!byChar[ch]) byChar[ch] = [];
    byChar[ch].push({ name, ...data });
  }
  const chars = Object.keys(byChar).sort();
  for (const ch of chars) {
    const dlgs = byChar[ch];
    dlgs.sort((a, b) => a.name.localeCompare(b.name));
    const filtered = searchTerm ? dlgs.filter(d =>
      d.name.toLowerCase().includes(searchTerm) ||
      ch.toLowerCase().includes(searchTerm) ||
      d.text.some(t => t.toLowerCase().includes(searchTerm))
    ) : dlgs;
    if (!filtered.length) continue;
    const group = document.createElement('div');
    group.className = 'tree-folder';
    const hdr = document.createElement('div');
    hdr.className = 'tree-folder-header';
    hdr.innerHTML = '<span class="chevron">‚ñº</span> <span>üë§</span> ' + esc(ch) +
      ' <span style="font-family:var(--font-mono);font-size:10px;color:var(--text-dim);margin-left:auto">' + filtered.length + '</span>';
    const kids = document.createElement('div');
    kids.className = 'tree-folder-children';
    hdr.addEventListener('click', () => { hdr.classList.toggle('collapsed'); kids.classList.toggle('hidden'); });
    for (const dlg of filtered) {
      const item = document.createElement('div');
      item.className = 'tree-item';
      item.style.paddingLeft = '20px';
      const lineCount = dlg.text.length;
      const evtCount = dlg.events.filter(e => crossRef.eventToMedia[e]).length;
      item.innerHTML = '<span class="icon">üí¨</span>' +
        '<span class="name" title="' + esc(dlg.name) + '">' + esc(dlg.name) + '</span>' +
        (lineCount ? '<span class="type-badge tb-dlg">' + lineCount + ' lines</span>' : '') +
        (evtCount ? '<span class="type-badge tb-audio">' + evtCount + ' audio</span>' : '');
      item.addEventListener('click', () => {
        treeContainer.querySelectorAll('.tree-item.active').forEach(e => e.classList.remove('active'));
        item.classList.add('active');
        selectDialogue(dlg);
      });
      kids.appendChild(item);
    }
    group.appendChild(hdr); group.appendChild(kids); frag.appendChild(group);
  }
  if (!chars.length) {
    const empty = document.createElement('div');
    empty.className = 'detail-empty'; empty.style.padding = '30px 16px';
    empty.innerHTML = '<div class="de-icon">üí¨</div><p>No dialogue files found.<br>Drop the Dialogue folder to see dialogues.</p>';
    frag.appendChild(empty);
  }
  return frag;
}

// ============================================================
// Dialogue Detail Panel
// ============================================================
function selectDialogue(dlg) {
  selectedAsset = dlg.asset;
  if (activeBlobUrl) { URL.revokeObjectURL(activeBlobUrl); activeBlobUrl = null; }
  detailPanel.style.display = '';
  detailPanel.scrollTop = 0;

  const resolvedEvts = dlg.events.filter(e => crossRef.eventToMedia[e]);
  const unresolvedEvts = dlg.events.filter(e => !crossRef.eventToMedia[e]);

  let html = '<div class="detail-header">' +
    '<div class="detail-name">üí¨ ' + esc(dlg.name) + '</div>' +
    '<div class="detail-path">Character: ' + esc(dlg.character) + '</div>' +
    '<div class="detail-tags">' +
      '<span class="meta-tag type-dlg">dialogue</span>' +
      '<span class="meta-tag">' + esc(dlg.asset.meta.type) + '</span>' +
    '</div></div>';

  // Stats
  html += '<div class="stats-bar">' +
    '<div class="stat"><span class="stat-value">' + dlg.text.length + '</span><span class="stat-label">lines</span></div>' +
    '<div class="stat"><span class="stat-value">' + dlg.events.length + '</span><span class="stat-label">events</span></div>' +
    '<div class="stat"><span class="stat-value">' + resolvedEvts.length + '</span><span class="stat-label">linked audio</span></div>' +
    '</div>';

  // Dialogue text
  if (dlg.text.length) {
    html += '<div class="detail-section"><div class="detail-section-title">Dialogue Text (' + dlg.text.length + ' lines)</div>' +
      '<div class="dialogue-lines">' + dlg.text.map(l => '<div class="dialogue-line">' + esc(l) + '</div>').join('') + '</div>' +
      '<div style="margin-top:6px"><button class="btn btn-secondary copy-dlg-btn">üìã Copy All</button></div></div>';
  }

  // Associated audio
  if (resolvedEvts.length) {
    html += '<div class="detail-section"><div class="detail-section-title">Associated Audio (' + resolvedEvts.length + ' events)</div>';
    for (let ei = 0; ei < resolvedEvts.length; ei++) {
      const evtName = resolvedEvts[ei];
      const mediaIds = crossRef.eventToMedia[evtName] || [];
      html += '<div class="track-row"><div class="track-meta">' +
        '<span class="meta-tag type-ogg" style="font-size:11px">' + esc(evtName) + '</span></div>';
      for (const mid of mediaIds) {
        const ma = crossRef.assetByName[mid];
        if (ma && ma.tracks.length) {
          for (let ti = 0; ti < ma.tracks.length; ti++) {
            const tr = ma.tracks[ti];
            const sizeKB = ((tr.end - tr.off) / 1024).toFixed(1);
            const tcls = tr.type==='ogg'?'type-ogg':tr.type==='wav'?'type-wav':'type-wem';
            html += '<div style="display:flex;align-items:center;gap:6px;flex-wrap:wrap;margin:4px 0 4px 12px">';
            html += '<span class="meta-tag ' + tcls + '">' + esc(tr.format) + '</span>';
            html += '<span class="meta-tag">' + sizeKB + ' KB</span>';
            if (tr.ch) html += '<span class="meta-tag">' + tr.ch + 'ch</span>';
            if (tr.sr) html += '<span class="meta-tag">' + tr.sr + ' Hz</span>';
            if (tr.playable) {
              html += '<div class="track-player" id="dlgtp' + ei + '_' + mid + '_' + ti + '" style="flex:1;min-width:120px"></div>';
              html += '<button class="btn btn-primary dlg-play-btn" data-mid="' + esc(mid) + '" data-tidx="' + ti + '" data-tpid="dlgtp' + ei + '_' + mid + '_' + ti + '" style="padding:3px 8px;font-size:11px">‚ñ∂ Play</button>';
              html += '<button class="btn btn-secondary dlg-dlogg-btn" data-mid="' + esc(mid) + '" data-tidx="' + ti + '" style="padding:3px 8px;font-size:11px">üíæ OGG</button>';
              html += '<button class="btn btn-secondary dlg-dlwav-btn" data-mid="' + esc(mid) + '" data-tidx="' + ti + '" style="padding:3px 8px;font-size:11px">üíæ WAV</button>';
            } else {
              html += '<div class="wwise-notice" style="flex:1;padding:4px 8px;font-size:11px">‚ö†Ô∏è ' + esc(tr.format) + '</div>';
              html += '<button class="btn btn-secondary dlg-dl-btn" data-mid="' + esc(mid) + '" data-tidx="' + ti + '" data-ext=".wem" style="padding:3px 8px;font-size:11px">üíæ WEM</button>';
            }
            html += '</div>';
          }
        } else {
          html += '<div style="margin:4px 0 4px 12px;font-size:11px;color:var(--text-dim)">Media ' + esc(mid) + ' ‚Äî not loaded</div>';
        }
      }
      html += '</div>';
    }
    html += '</div>';
  }

  // Unresolved events
  if (unresolvedEvts.length) {
    html += '<div class="detail-section"><div class="detail-section-title">Unresolved Events (' + unresolvedEvts.length + ')</div>' +
      '<div style="font-size:11px;color:var(--text-dim);font-family:var(--font-mono)">' +
      unresolvedEvts.map(e => '<div style="padding:2px 0">' + esc(e) + '</div>').join('') +
      '</div><div style="margin-top:6px;font-size:11px;color:var(--text-dim)">Load the WwiseAudio/Localized/ folder to resolve these events to audio files.</div></div>';
  }

  detailPanel.innerHTML = html;
  detailPanel.onclick = onDlgDetailClick;
}

async function onDlgDetailClick(e) {
  const btn = e.target.closest('button');
  if (!btn) return;
  if (btn.classList.contains('dlg-play-btn')) {
    const mid = btn.dataset.mid, tidx = +btn.dataset.tidx, tpid = btn.dataset.tpid;
    const ma = crossRef.assetByName[mid];
    if (!ma) return;
    const tr = ma.tracks[tidx];
    if (!tr) return;
    const container = $(tpid);
    if (!container) return;
    if (!container.querySelector('audio')) {
      const blob = await materializeBlob(ma, tr);
      if (!blob) return;
      if (activeBlobUrl) URL.revokeObjectURL(activeBlobUrl);
      activeBlobUrl = URL.createObjectURL(blob);
      container.innerHTML = '<audio controls autoplay style="width:100%;height:32px;border-radius:6px;outline:none" src="' + activeBlobUrl + '"></audio>';
      btn.textContent = '‚è∏ Pause';
    } else {
      const audio = container.querySelector('audio');
      if (audio.paused) { audio.play(); btn.textContent = '‚è∏ Pause'; }
      else { audio.pause(); btn.textContent = '‚ñ∂ Play'; }
    }
  } else if (btn.classList.contains('dlg-dl-btn')) {
    const mid = btn.dataset.mid, tidx = +btn.dataset.tidx, ext = btn.dataset.ext;
    const ma = crossRef.assetByName[mid];
    if (!ma) return;
    const tr = ma.tracks[tidx];
    if (!tr) return;
    const blob = await materializeBlob(ma, tr);
    if (blob) downloadBlob(getDownloadName(ma), blob, ext, tidx);
  } else if (btn.classList.contains('dlg-dlogg-btn')) {
    const mid = btn.dataset.mid, tidx = +btn.dataset.tidx;
    const ma = crossRef.assetByName[mid];
    if (!ma) return;
    const tr = ma.tracks[tidx];
    if (!tr) return;
    handleOggDl(btn, getDownloadName(ma), ma, tr, tidx);
  } else if (btn.classList.contains('dlg-dlwav-btn')) {
    const mid = btn.dataset.mid, tidx = +btn.dataset.tidx;
    const ma = crossRef.assetByName[mid];
    if (!ma) return;
    const tr = ma.tracks[tidx];
    if (!tr) return;
    handleWavDl(btn, getDownloadName(ma), ma, tr, tidx);
  } else if (btn.classList.contains('copy-dlg-btn')) {
    const dlg = Object.values(crossRef.dialogueData).find(d => d.asset === selectedAsset);
    if (dlg) {
      navigator.clipboard.writeText(dlg.text.join('\n\n'));
      btn.textContent = '‚úì Copied!';
      setTimeout(() => { btn.textContent = 'üìã Copy All'; }, 1200);
    }
  }
}

function findSig(b,s,f){const l=s.length,e=b.length-l;for(let i=f;i<=e;i++)if(b[i]===s[0]&&b[i+1]===s[1]&&b[i+2]===s[2]&&b[i+3]===s[3])return i;return-1;}
function wStr(v,o,s){for(let i=0;i<s.length;i++)v.setUint8(o+i,s.charCodeAt(i));}
function esc(s){return s?s.replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])):''}
function sanitize(n){return n.replace(/[^a-zA-Z0-9_\-\.]/g,'_').slice(0,100)||'audio';}

// ============================================================
// UI helpers
// ============================================================
function showProgress(p){const b=$('progressBar'),f=$('progressFill');if(b)b.style.display='';if(f){f.style.width=p+'%';}lastPT=performance.now();}
function hideProgress(){const b=$('progressBar'),f=$('progressFill');if(b)b.style.display='none';if(f)f.style.width='0%';}
function showStatus(t){const s=$('statusText');if(s){s.style.display='flex';const sp=s.querySelector('span');if(sp)sp.textContent=t;}}
function hideStatus(){const s=$('statusText');if(s)s.style.display='none';}

function resetUI() {
  if (activeBlobUrl) { URL.revokeObjectURL(activeBlobUrl); activeBlobUrl=null; }
  allAssets=[]; fileTree={}; selectedAsset=null; currentFilter='all'; treeItemEls=[];
  crossRef = { eventToMedia:{}, mediaToEvent:{}, dialogueData:{}, mediaToDialogue:{}, assetByName:{} };
  fileTreeFrag = null;
  stagedEntries=[]; isStaging=false; stagingBusy=0;
  detailPanel.style.display='none'; detailPanel.innerHTML='';
  // Restore dropzone
  dropzoneWrapper.classList.remove('collapsed');
  dropzoneWrapper.innerHTML =
    '<div id="dropzone" class="dropzone">' +
      '<span class="dropzone-icon">üì¶</span>' +
      '<h3>Drop your Unreal assets here</h3>' +
      '<p>Drag folders or .uasset / .uexp / .ubulk files</p>' +
      '<div class="hint">OGG/WAV ¬∑ Wwise WEM ¬∑ DlgSystem dialogue ¬∑ .ubulk</div>' +
      '<input id="fileInput" type="file" class="hidden-input" webkitdirectory multiple />' +
    '</div>' +
    '<div class="progress-bar" id="progressBar" style="display:none"><div class="fill" id="progressFill"></div></div>' +
    '<div id="statusText" class="loading" style="display:none"><div class="spinner"></div><span>Processing...</span></div>';
  // Rebind
  const dz = $('dropzone'), fi = $('fileInput');
  dz.addEventListener('click', onDropzoneClick);
  dz.addEventListener('dragover', e => { e.preventDefault(); dz.classList.add('dragover'); });
  dz.addEventListener('dragleave', () => dz.classList.remove('dragover'));
  dz.addEventListener('drop', handleDrop);
  fi.addEventListener('change', e => stageFolder(e.target.files));

  treeContainer.innerHTML = '<div class="detail-empty" style="padding:30px 16px"><div class="de-icon">üéÆ</div><p>Drop files to browse</p></div>';
  fileCountEl.textContent = '0';
  const _si = $('searchInput'); if (_si) _si.value = '';
  const _sc = $('searchClear'); if (_sc) _sc.style.display = 'none';
  $('searchRow').style.display = 'none';
  filterPills.style.display = 'none';
  filterPills.querySelector('.active')?.classList.remove('active');
  filterPills.querySelector('[data-filter="all"]').classList.add('active');
  downloadAllOggBtn.disabled=true; downloadAllWavBtn.disabled=true; resetBtn.disabled=true;
  hideProgress(); hideStatus();
}
</script>
</body>
</html>
